@model RedTeam.Models.CarSimulator


@{
    ViewBag.Title = "Car Simulator";
}

<h2>Car Simulator</h2>

<div class="">
    <input type="checkbox" checked="@Model.doorLock" id="doorlock" />
    <input type="checkbox" checked="@Model.carLight" id="carlight" />
    <input type="checkbox" checked="@Model.carEngine" id="carengine" />
    <input type="checkbox" checked="@Model.trunkOpen" id="trunkopen" />
</div>

<div class="container">
    <h2 class="h5">Current Speed</h2>
    <input type="text" id="currentSpeed" />
    <input type="button" id="updateSpeed" value="Update" />

    <ul id="logmessage"></ul>
</div>
<div class="container">
    <h2 class="h5">Current Gas Level</h2>
    <input type="text" id="currentGasLevel" />
    <input type="button" id="updateGas" value="Update" />

    <ul id="gaslogmessage"></ul>
</div>
@section scripts {
    <!--Reference the SignalR library. -->
    <script src="~/Scripts/jquery.signalR-2.1.2.min.js"></script>
    <!--Reference the autogenerated SignalR hub script. -->
    <script src="~/signalr/hubs"></script>
    <!--SignalR script to update the chat page and send messages.-->
    <script>
        $(function () {
            var carSimulator = $.connection.carSimulatorHub;  // Reference the auto-generated proxy for the hub.

            carSimulator.client.doorLock = function (locked) {  // Create a function that the hub can call back to display messages.
                $("#doorlock").prop('checked', locked);
            };
            carSimulator.client.carLights = function (off) {
                $("#carlight").prop('checked', off);
            };

            carSimulator.client.carEngine = function (off) {
                $("#carengine").prop('checked', off);
            };

            carSimulator.client.trunkOpen = function (off) {
                $("#trunkopen").prop('checked', off);
            };

            $.connection.hub.start().done(function () {
                $('#updateSpeed').click(function () {
                    carSimulator.server.sendSpeed($('#currentSpeed').val()); // Call the Send method on the hub.
                    // Clear text box and reset focus for next comment.
                    // Html encode display name and message.
                    var encodedspeed = $('<div />').text($('#currentSpeed').val()).html();

                    $('#logmessage').append('<li><strong>' + 'Car current speed is: ' + encodedspeed + ' Mph' + '</li>'); // Add the message to the page.
                    //$('#logmessage').append('<li><strong>' + 'Car current speed' + encodedspeed + '</li>');

                });
            });
            $.connection.hub.start().done(function () {
                $('#updateGas').click(function () {
                    // Call the Send method on the hub.
                    carSimulator.server.sendGas($('#currentGasLevel').val());

                    // Html encode display name and message.
                    var encodedgas = $('<div />').text($('#currentGasLevel').val()).html();

                    // Add the message to the page.
                    $('#gaslogmessage').append('<li><strong>' + 'Car current gas level is: ' + encodedgas + ' gallons' + '</li>');
                    //$('#logmessage').append('<li><strong>' + 'Car current speed' + encodedspeed + '</li>');

                });
            });



            $.connection.hub.start();
        });


    </script>
}



